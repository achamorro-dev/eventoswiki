---
import { Button } from '../../core/components/atoms/button/button'
import { GradientTitle } from '../../core/components/atoms/gradient-title/gradient-title'
import { Link } from '../../core/components/atoms/link/link'
import EventsGrid from '../../core/components/organisms/events-grid/events-grid.astro'
import type { AstroEvent } from '../../core/events/astro-event'
import { EventUtils } from '../../core/events/event-utils'
import Layout from '../../layouts/layout.astro'

export async function getStaticPaths({ paginate }: { paginate: any }) {
  const events = (await Astro.glob('../eventos/**/*.mdx')) as AstroEvent[]

  const eventsFiltered = EventUtils.getNextEvents(events)
  const eventsSortered = EventUtils.sortByStartDateAsc(eventsFiltered)

  return paginate(eventsSortered, { pageSize: 9 })
}

const { page } = Astro.props as { page: { url: { next: string; prev: string }; data: Array<AstroEvent> } }
const nextPage = page.url.next
const prevPage = page.url.prev
---

<Layout title="eventos.wiki - Pr칩ximos eventos">
  <div class="flex items-center justify-between mt-4 mb-10">
    <GradientTitle>Pr칩ximos eventos</GradientTitle>
    <Link href="/eventos/archivados/1" className="text-right">Ver pasados</Link>
  </div>
  <EventsGrid events={page.data} />
  <div class="flex justify-between mt-8">
    {
      prevPage ? (
        <Button type="link" variant="text" href={prevPage}>
          P치gina anterior
        </Button>
      ) : (
        <div />
      )
    }
    {
      nextPage && (
        <Button type="link" href={nextPage}>
          Siguiente p치gina
        </Button>
      )
    }
  </div>
</Layout>
