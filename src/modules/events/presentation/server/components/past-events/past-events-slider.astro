---
import { EventsContainer } from '@/events/di/events.container'
import { GetPastEventsQuery } from '@/events/application/get-past-events.query'
import EventsSlider from '@/ui/components/events-slider/events-slider.astro'
import { Urls } from '@/ui/urls/urls'

interface Props {
  locationId?: string
  locationName?: string
}

const { locationId, locationName } = Astro.props
const { data: pastEvents } = await EventsContainer.get(GetPastEventsQuery).execute({ count: 10, location: locationId })

const eventsWithPrice = pastEvents.map(event => {
  const minPrice = 'getMinTicketPrice' in event ? (event as any).getMinTicketPrice() : null
  return {
    ...event,
    minPrice,
  }
})
---

<EventsSlider
  title={'Eventos pasados' + (locationName ? ` en ${locationName}` : '')}
  seeMoreLink={Urls.PAST_EVENTS}
  goToEvent={Urls.EVENT}
  events={eventsWithPrice}
/>
